# Gmail Integration

## Overview

Zetherion AI can connect to your Gmail account to check emails, generate digests, draft replies, and search your inbox -- all from Discord. The integration supports multiple Gmail accounts, progressive trust for automated actions, and privacy-first design that keeps you in control of your data.

---

## Setting Up Gmail

### Prerequisites

Before connecting Gmail to Zetherion AI, you need:

- A Gmail account with API access enabled
- OAuth 2.0 credentials configured for the Zetherion AI application (see the deployment guide for setup instructions)
- The Zetherion AI bot running with all 6 Docker services operational

### Connecting Your Account

To start the OAuth flow, send the following command in Discord:

```
@Zetherion AI connect gmail
```

The bot will reply with a unique authorization link. Click the link to open Google's consent screen, where you will:

1. Sign in to your Gmail account (if not already signed in).
2. Review the permissions Zetherion AI is requesting.
3. Click "Allow" to grant access.

Once authorized, the bot confirms the connection and begins syncing your inbox metadata.

You can connect multiple Gmail accounts by repeating this process with different Google accounts.

### Checking Connection Status

To verify your Gmail connection at any time:

```
@Zetherion AI gmail status
```

This triggers the `email_status` intent and displays:

- Connected Gmail accounts
- Last sync timestamp for each account
- Current trust level (see the Trust System section below)
- Any active errors or warnings

---

## Using Gmail

### Check Your Email

```
@Zetherion AI check my email
```

This triggers the `email_check` intent and provides a summary across all connected accounts:

- Total email count
- Unread email count
- High-priority items (flagged or from known important senders)
- A brief overview of recent activity

### View Unread Emails

```
@Zetherion AI show unread emails
```

This triggers the `email_unread` intent and lists up to 5 unread emails, showing:

- Sender name and address
- Subject line
- Received timestamp

If you have more than 5 unread emails, the bot will indicate the total count and show the most recent ones.

### Email Digests

```
@Zetherion AI morning digest
@Zetherion AI evening digest
@Zetherion AI weekly digest
```

This triggers the `email_digest` intent and generates an AI-summarized digest of your email activity. Digests are organized by:

- Priority level (urgent, important, informational)
- Topic or sender grouping
- Action items extracted from email content

The digest is generated using Gemini 2.5 Flash for speed, with Claude Sonnet 4.5 or GPT-5.2 used when deeper analysis is needed for complex email threads.

### Search Emails

```
@Zetherion AI search emails for invoice
@Zetherion AI find emails about project update
@Zetherion AI search my email for meeting notes
```

This triggers the `email_search` intent and searches across all connected accounts by:

- Subject line
- Sender name and address
- Email body content (where available)

Results are returned with subject, sender, date, and a brief snippet of matching content.

### View Drafts

```
@Zetherion AI show my drafts
```

This triggers the `email_drafts` intent and lists pending reply drafts that have been auto-generated by the trust system and are awaiting your review. Each draft shows:

- The original email subject and sender
- A preview of the drafted reply
- Options to approve, edit, or discard

### Calendar Events from Email

```
@Zetherion AI check my email calendar
@Zetherion AI any upcoming events in my email?
```

This triggers the `email_calendar` intent and extracts calendar-related information from your emails, such as meeting invitations, event confirmations, and scheduling requests.

---

## Trust System

Zetherion AI uses a progressive trust system for Gmail actions. This means the bot starts with minimal permissions and earns greater autonomy as you build confidence in its behavior.

### How Trust Works

**Level 1 -- Read Only (default)**
When you first connect Gmail, the bot can only read and summarize emails. It cannot draft, send, or modify anything.

**Level 2 -- Draft with Approval**
After consistent use, the bot begins drafting replies for your review. Every draft must be explicitly approved by you before it is sent. You will see drafts listed when you run "show my drafts."

**Level 3 -- Auto-Draft**
Once you have approved a sufficient number of drafts, the bot can automatically create drafts without prompting you. Drafts are still not sent automatically -- they remain in your drafts folder for review.

**Level 4 -- Auto-Send (configurable)**
At the highest trust level, the bot can send replies on your behalf for specific contacts and email types. This level is never enabled by default and must be explicitly configured by you.

### Trust is Granular

Trust is tracked at a granular level:

- **Per contact:** The bot may be trusted to auto-draft replies to a frequent collaborator but remain at read-only for unknown senders.
- **Per email type:** Routine acknowledgments may reach auto-send level while sensitive topics remain at draft-with-approval.

### Managing Trust

You always maintain full control over trust levels. You can:

- Review current trust levels via "gmail status"
- Revoke trust for specific contacts or globally at any time
- Reset trust to read-only if desired

---

## Privacy

Zetherion AI is designed with privacy as a core principle for the Gmail integration.

- **OAuth tokens** are stored securely using encryption at rest. They are never exposed in logs or error messages.
- **Email content** is encrypted at rest within the bot's storage. Content is only decrypted when actively processing a request.
- **No email content is sent to cloud LLMs without your consent.** By default, only metadata (sender, subject, timestamp) is sent for processing. Full email body content is only sent to cloud models (Claude Sonnet 4.5, GPT-5.2, Gemini 2.5 Flash) when the task requires it and you have authorized it.
- **Trust can be revoked at any time.** Revoking trust immediately stops all automated actions.
- **Data export and deletion** are available via profile commands. You can request a full export of all Gmail-related data or delete it entirely.

---

## Automatic Digests

The heartbeat scheduler can send periodic email digests at configurable times without you needing to ask. This is useful for staying on top of your inbox with a daily morning summary or a weekly roundup.

### Configuration

Automatic digests are configured through the bot's scheduling system. Common configurations include:

- **Morning digest** -- Sent at a configured time each morning (e.g., 8:00 AM in your timezone) with overnight email activity.
- **Evening digest** -- Sent at end of day with a summary of the day's email activity.
- **Weekly digest** -- Sent once per week (e.g., Monday morning) with a high-level summary of the past week.

Digest times and frequency are configurable in the bot's environment settings. The heartbeat scheduler runs as part of the 6 Docker services that make up the Zetherion AI deployment.

---

## Troubleshooting

### OAuth Errors

**Problem:** "OAuth authentication failed" or "Unable to connect Gmail"

**Solutions:**
1. Verify that OAuth 2.0 credentials are correctly configured in the bot's environment.
2. Check that the Gmail API is enabled in the Google Cloud Console.
3. Ensure the redirect URI matches what is configured in your OAuth client.
4. Try disconnecting and reconnecting your account:
   ```
   @Zetherion AI disconnect gmail
   @Zetherion AI connect gmail
   ```

### "Gmail is not configured"

**Problem:** The bot responds that Gmail is not configured.

**Solutions:**
1. Confirm that the Gmail service credentials are present in the bot's environment variables.
2. Verify that the Gmail-related Docker service is running (check with `docker ps` or the bot's status command).
3. Check the bot logs for configuration errors at startup.

### No Accounts Connected

**Problem:** "No Gmail accounts connected" when running Gmail commands.

**Solutions:**
1. Run `@Zetherion AI connect gmail` to start the OAuth flow.
2. Complete the full authorization process in your browser.
3. Check that the OAuth callback was received by verifying with `@Zetherion AI gmail status`.

### Sync Issues

**Problem:** Emails appear outdated or missing.

**Solutions:**
1. Check the last sync time with `@Zetherion AI gmail status`.
2. Verify that the bot's heartbeat scheduler is running (responsible for periodic syncs).
3. Check network connectivity between the bot and Gmail API.
4. If the issue persists, disconnect and reconnect your Gmail account to reset the sync state.

### Rate Limiting from Google

**Problem:** "Rate limit exceeded" errors from Gmail API.

**Solutions:**
1. Wait a few minutes and try again. Google enforces per-user and per-application rate limits.
2. Reduce the frequency of automatic digest scheduling if configured for very frequent checks.
3. Check the Google Cloud Console for quota usage details.

---

## Related Guides

- [Commands Reference](commands.md) -- Full list of all Zetherion AI commands
- [Security](../technical/security.md) -- Security architecture and privacy details
- [Configuration](../technical/configuration.md) -- Environment variables and deployment configuration
